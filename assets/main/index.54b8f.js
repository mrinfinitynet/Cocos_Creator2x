window.__require=function t(e,n,r){function i(a,s){if(!n[a]){if(!e[a]){var c=a.split("/");if(c=c[c.length-1],!e[c]){var u="function"==typeof __require&&__require;if(!s&&u)return u(c,!0);if(o)return o(c,!0);throw new Error("Cannot find module '"+a+"'")}a=c}var l=n[a]={exports:{}};e[a][0].call(l.exports,function(t){return i(e[a][1][t]||t)},l,l.exports,t,e,n,r)}return n[a].exports}for(var o="function"==typeof __require&&__require,a=0;a<r.length;a++)i(r[a]);return i}({APIService:[function(t,e,n){"use strict";function r(){r=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(S){c=function(t,e,n){return t[e]=n}}function u(t,e,n,r){var i=e&&e.prototype instanceof f?e:f,o=Object.create(i.prototype),a=new B(r||[]);return o._invoke=function(t,e,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return{value:void 0,done:!0}}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=A(a,n);if(s){if(s===h)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var c=l(t,e,n);if("normal"===c.type){if(r=n.done?"completed":"suspendedYield",c.arg===h)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r="completed",n.method="throw",n.arg=c.arg)}}}(t,n,a),o}function l(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(S){return{type:"throw",arg:S}}}t.wrap=u;var h={};function f(){}function d(){}function p(){}var v={};c(v,o,function(){return this});var g=Object.getPrototypeOf,m=g&&g(g(T([])));m&&m!==e&&n.call(m,o)&&(v=m);var y=p.prototype=f.prototype=Object.create(v);function N(t){["next","throw","return"].forEach(function(e){c(t,e,function(t){return this._invoke(e,t)})})}function b(t,e){function r(i,o,a,s){var c=l(t[i],t,o);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==typeof h&&n.call(h,"__await")?e.resolve(h.__await).then(function(t){r("next",t,a,s)},function(t){r("throw",t,a,s)}):e.resolve(h).then(function(t){u.value=t,a(u)},function(t){return r("throw",t,a,s)})}s(c.arg)}var i;this._invoke=function(t,n){function o(){return new e(function(e,i){r(t,n,e,i)})}return i=i?i.then(o,o):o()}}function A(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,A(t,e),"throw"===e.method))return h;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return h}var r=l(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,h;var i=r.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,h):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,h)}function C(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function E(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function B(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(C,this),this.reset(!0)}function T(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,i=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:w}}function w(){return{value:void 0,done:!0}}return d.prototype=p,c(y,"constructor",p),c(p,"constructor",d),d.displayName=c(p,s,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===d||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,c(t,s,"GeneratorFunction")),t.prototype=Object.create(y),t},t.awrap=function(t){return{__await:t}},N(b.prototype),c(b.prototype,a,function(){return this}),t.AsyncIterator=b,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var a=new b(u(e,n,r,i),o);return t.isGeneratorFunction(n)?a:a.next().then(function(t){return t.done?t.value:a.next()})},N(y),c(y,s,"Generator"),c(y,o,function(){return this}),c(y,"toString",function(){return"[object Generator]"}),t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=T,B.prototype={constructor:B,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(E),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=n.call(o,"catchLoc"),c=n.call(o,"finallyLoc");if(s&&c){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,h):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),E(n),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;E(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:T(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),h}},t}function i(t,e,n,r,i,o,a){try{var s=t[o](a),c=s.value}catch(u){return void n(u)}s.done?e(c):Promise.resolve(c).then(r,i)}function o(t){return function(){var e=this,n=arguments;return new Promise(function(r,o){var a=t.apply(e,n);function s(t){i(a,r,o,s,c,"next",t)}function c(t){i(a,r,o,s,c,"throw",t)}s(void 0)})}}cc._RF.push(e,"c074bAN3kRAQqo42nygLjTh","APIService"),n.__esModule=!0,n.APIService=void 0;var a=function(){function t(t,e,n,r){this.config=t,this.endpoints=e,this.constants=n,this.logger=r,this.baseUrl=t.apiBaseUrl,this.token=null}var e=t.prototype;return e.setToken=function(t){this.token=t},e.setBaseUrl=function(t){this.baseUrl=t},e.request=function(t,e,n){var r=this;return void 0===n&&(n={}),new Promise(function(i,o){var a=n,s=a.headers,c=void 0===s?{}:s,u=a.body,l=void 0===u?null:u,h=a.requiresAuth,f=void 0!==h&&h,d=new XMLHttpRequest,p=""+r.baseUrl+e;d.open(t,p,!0),f&&r.token&&d.setRequestHeader("Authorization",r.token),l&&d.setRequestHeader("Content-Type","application/json"),Object.entries(c).forEach(function(t){var e=t[0],n=t[1];d.setRequestHeader(e,n)}),d.onload=function(){if(d.status>=200&&d.status<300)try{var t=JSON.parse(d.responseText);r.logger.logResponse(p,t),i(t)}catch(e){r.logger.error("Failed to parse response:",e),o(new Error("Invalid server response"))}else o(new Error("HTTP "+d.status))},d.onerror=function(){r.logger.error("Network error"),o(new Error("Network error"))},d.timeout=r.constants.NETWORK.REQUEST_TIMEOUT,d.ontimeout=function(){o(new Error("Request timeout"))},r.logger.logRequest(t,p,l),d.send(l?JSON.stringify(l):null)})},e.getServerInfo=function(){var t=o(r().mark(function t(){return r().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.request("POST",this.endpoints.SERVER_INFO,{requiresAuth:!0}));case 1:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),e.getGameData=function(){var t=o(r().mark(function t(){return r().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.request("POST",this.endpoints.GAME_DATA,{requiresAuth:!0}));case 1:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),e.insertBet=function(){var t=o(r().mark(function t(e){return r().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.request("POST",this.endpoints.BETTING_INSERT,{body:e,requiresAuth:!0}));case 1:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),e.getUserInfo=function(){var t=o(r().mark(function t(){return r().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.request("POST",this.endpoints.USER_INFO,{requiresAuth:!0}));case 1:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),e.updateUserRank=function(){var t=o(r().mark(function t(e){return r().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.request("POST",this.endpoints.USER_RANK,{body:e,requiresAuth:!0}));case 1:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),t}();n.APIService=a,cc._RF.pop()},{}],AudioService:[function(t,e,n){"use strict";cc._RF.push(e,"4fee0vstMRGC5rLQan8qaC2","AudioService"),n.__esModule=!0,n.AudioService=void 0;var r=function(){function t(t){this.constants=t,this.musicClip=null,this.effectClip=null,this.coinsClip=null,this.musicVolume=t.AUDIO.DEFAULT_MUSIC_VOLUME,this.effectVolume=t.AUDIO.DEFAULT_EFFECT_VOLUME,this.musicID=null}var e=t.prototype;return e.setAudioClips=function(t){var e=t.music,n=t.effect,r=t.coins;this.musicClip=e,this.effectClip=n,this.coinsClip=r},e.playMusic=function(t){void 0===t&&(t=!0),this.musicClip&&(this.musicID||(cc.audioEngine.stopMusic(),cc.audioEngine.setMusicVolume(this.musicVolume),cc.audioEngine.playMusic(this.musicClip,t),this.musicID=!0))},e.setMusicVolume=function(t){this.musicVolume=Math.max(0,Math.min(1,t)),cc.audioEngine.setMusicVolume(this.musicVolume)},e.setEffectVolume=function(t){this.effectVolume=Math.max(0,Math.min(1,t)),cc.audioEngine.setEffectsVolume(this.effectVolume)},e.playEffectSound=function(){this.effectClip&&cc.audioEngine.playEffect(this.effectClip,!1)},e.playCoinSound=function(){if(this.coinsClip){var t=cc.audioEngine.playEffect(this.coinsClip,!1);cc.audioEngine.setVolume(t,this.effectVolume)}},e.stopMusic=function(){cc.audioEngine.stopMusic(),this.musicID=null},e.stopAllEffects=function(){cc.audioEngine.stopAllEffects()},t}();n.AudioService=r,cc._RF.pop()},{}],BalanceFormatter:[function(t,e,n){"use strict";cc._RF.push(e,"5b87dRS29tHWaXLDe0unwH8","BalanceFormatter"),n.__esModule=!0,n.BalanceFormatter=void 0;var r=function(){function t(){}var e=t.prototype;return e.format=function(t){return(t=Number(t))>=1e6?Math.floor(t/1e6)+"M":t>=1e3?Math.floor(t/1e3)+"K":t.toString()},e.parse=function(t){if("number"==typeof t)return t;var e=t.toString().trim().toUpperCase(),n=1;e.endsWith("M")?(n=1e6,e=e.slice(0,-1)):e.endsWith("K")&&(n=1e3,e=e.slice(0,-1));var r=parseFloat(e);return isNaN(r)?null:r*n},t}();n.BalanceFormatter=r,cc._RF.pop()},{}],BettingController:[function(t,e,n){"use strict";function r(){r=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(S){c=function(t,e,n){return t[e]=n}}function u(t,e,n,r){var i=e&&e.prototype instanceof f?e:f,o=Object.create(i.prototype),a=new B(r||[]);return o._invoke=function(t,e,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return{value:void 0,done:!0}}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=A(a,n);if(s){if(s===h)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var c=l(t,e,n);if("normal"===c.type){if(r=n.done?"completed":"suspendedYield",c.arg===h)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r="completed",n.method="throw",n.arg=c.arg)}}}(t,n,a),o}function l(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(S){return{type:"throw",arg:S}}}t.wrap=u;var h={};function f(){}function d(){}function p(){}var v={};c(v,o,function(){return this});var g=Object.getPrototypeOf,m=g&&g(g(T([])));m&&m!==e&&n.call(m,o)&&(v=m);var y=p.prototype=f.prototype=Object.create(v);function N(t){["next","throw","return"].forEach(function(e){c(t,e,function(t){return this._invoke(e,t)})})}function b(t,e){function r(i,o,a,s){var c=l(t[i],t,o);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==typeof h&&n.call(h,"__await")?e.resolve(h.__await).then(function(t){r("next",t,a,s)},function(t){r("throw",t,a,s)}):e.resolve(h).then(function(t){u.value=t,a(u)},function(t){return r("throw",t,a,s)})}s(c.arg)}var i;this._invoke=function(t,n){function o(){return new e(function(e,i){r(t,n,e,i)})}return i=i?i.then(o,o):o()}}function A(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,A(t,e),"throw"===e.method))return h;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return h}var r=l(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,h;var i=r.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,h):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,h)}function C(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function E(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function B(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(C,this),this.reset(!0)}function T(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,i=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:w}}function w(){return{value:void 0,done:!0}}return d.prototype=p,c(y,"constructor",p),c(p,"constructor",d),d.displayName=c(p,s,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===d||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,c(t,s,"GeneratorFunction")),t.prototype=Object.create(y),t},t.awrap=function(t){return{__await:t}},N(b.prototype),c(b.prototype,a,function(){return this}),t.AsyncIterator=b,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var a=new b(u(e,n,r,i),o);return t.isGeneratorFunction(n)?a:a.next().then(function(t){return t.done?t.value:a.next()})},N(y),c(y,s,"Generator"),c(y,o,function(){return this}),c(y,"toString",function(){return"[object Generator]"}),t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=T,B.prototype={constructor:B,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(E),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=n.call(o,"catchLoc"),c=n.call(o,"finallyLoc");if(s&&c){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,h):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),E(n),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;E(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:T(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),h}},t}function i(t,e,n,r,i,o,a){try{var s=t[o](a),c=s.value}catch(u){return void n(u)}s.done?e(c):Promise.resolve(c).then(r,i)}cc._RF.push(e,"52f82SXnF5JQKUftokzGjvq","BettingController"),n.__esModule=!0,n.BettingController=void 0;var o=function(){function t(t,e,n,r,i,o){this.constants=t,this.state=e,this.api=n,this.validator=r,this.encoder=i,this.logger=o,this.debounceTimer=null}var e=t.prototype;return e.placeBet=function(t,e){var n=this.state.getGameState(),r=this.state.getUser(),i=this.validator.validateBet({boardNumber:t,coinAmount:n.selectedCoinAmount,userBalance:r.amount,insertBoards:n.insertBoards});if(!i.valid)return{success:!1,error:i.error};this.state.addBettingBoard(t);var o=this.encoder.encode(t,n.selectedCoinNumber);return this.state.addBet(t,o,n.selectedCoinAmount),this.state.deductBalance(n.selectedCoinAmount),this.updateBoardUI(t,n.selectedCoinAmount,e),this.updateBalanceUI(e),this.scheduleBatchSend(e),e.boardUI.updateYouAmount(t,n.selectedCoinAmount),{success:!0}},e.updateBoardUI=function(t,e,n){if(n.youAmounts&&n.youAmounts[t]){var r=Number(n.youAmounts[t].string);n.youAmounts[t].string=(r+e).toString()}},e.updateBalanceUI=function(t){var e=this.state.getUser();t.UsersAmount&&t.formatter&&(t.UsersAmount.string=t.formatter.format(e.amount))},e.scheduleBatchSend=function(t){var e=this;this.debounceTimer&&clearTimeout(this.debounceTimer),this.debounceTimer=setTimeout(function(){e.sendBatchedBets(t),e.debounceTimer=null},this.constants.TIMING.DEBOUNCE_DELAY)},e.sendBatchedBets=function(){var t,e=(t=r().mark(function t(e){var n,i,o,a,s;return r().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n=this.state.getUser(),i=1;case 2:if(!(i<=this.constants.BOARD.COUNT)){t.next=21;break}if(!((o=this.state.getBoardBets(i)).coins.length>0)){t.next=18;break}return t.prev=5,a={rank:n.rank,coins:[].concat(o.coins),amount:o.amount,board:i},this.state.clearBoardBets(i),t.next=10,this.api.insertBet(a);case 10:(s=t.sent)&&!s.status&&(e.toastrNotice&&e.toastrNotice(s.msg||"Bet failed"),"RELOAD"===s.msg&&e.loadGameScene("Error")),t.next=18;break;case 14:t.prev=14,t.t0=t.catch(5),this.logger.error("Failed to send bet:",t.t0),e.toastrNotice&&e.toastrNotice(t.t0.message||"Failed to place bet");case 18:i++,t.next=2;break;case 21:case"end":return t.stop()}},t,this,[[5,14]])}),function(){var e=this,n=arguments;return new Promise(function(r,o){var a=t.apply(e,n);function s(t){i(a,r,o,s,c,"next",t)}function c(t){i(a,r,o,s,c,"throw",t)}s(void 0)})});return function(t){return e.apply(this,arguments)}}(),e.forceSendPendingBets=function(t){this.debounceTimer&&(clearTimeout(this.debounceTimer),this.debounceTimer=null),this.sendBatchedBets(t)},e.resetBets=function(){this.state.resetAllBets()},t}();n.BettingController=o,cc._RF.pop()},{}],BoardUI:[function(t,e,n){"use strict";cc._RF.push(e,"97366j8JSFN0YuzGWKq/Vyd","BoardUI"),n.__esModule=!0,n.BoardUI=void 0;var r=function(){function t(t,e,n){this.constants=t,this.formatter=e,this.logger=n,this.boards=null,this.frames=null,this.boardsNode=null,this.framesNode=null,this.coinInsertBoards=null,this.potAmounts=[],this.youAmounts=[],this.instantiatedPrefabs=[]}var e=t.prototype;return e.initialize=function(t,e,n){this.boardsNode=t.getChildByName("Boards"),this.boards=this.boardsNode.children,this.framesNode=t.getChildByName("Frames"),this.frames=this.framesNode.children,this.coinInsertBoards=e,this.coinPrefabs=n,this.cacheAmountLabels()},e.cacheAmountLabels=function(){this.potAmounts=[],this.youAmounts=[];for(var t=1;t<=this.constants.BOARD.COUNT;t++){var e=this.boardsNode.getChildByName("Board_"+t),n=e.getChildByName("Pot");this.potAmounts[t]=n.getChildByName("Amount").getComponent(cc.Label);var r=e.getChildByName("You");this.youAmounts[t]=r.getChildByName("Amount").getComponent(cc.Label)}},e.showCoinAnimation=function(t,e){var n=this.getRandomBoardPosition(t),r=n.randomx,i=n.randomy,o=cc.instantiate(this.getCoinPrefab(e));o.setPosition(cc.v2(0,0)),this.coinInsertBoards[t].addChild(o),this.instantiatedPrefabs.push(o),cc.tween(o).to(this.constants.ANIMATION.COIN_FALL_DURATION,{position:cc.v2(r,i)}).start()},e.getRandomBoardPosition=function(t){var e=this.constants.BOARD.POSITIONS[t]||this.constants.BOARD.POSITIONS[3],n=function(t,e){return Math.random()*(e-t)+t};return{randomx:n(e.minX,e.maxX),randomy:n(e.minY,e.maxY)}},e.getCoinPrefab=function(t){return this.coinPrefabs[t]||this.coinPrefabs[5]},e.clearAllCoins=function(){this.instantiatedPrefabs.forEach(function(t){t.removeFromParent(),t.destroy()}),this.instantiatedPrefabs=[]},e.updateYouAmount=function(t,e){if(this.youAmounts&&this.youAmounts[t]){var n=Number(this.youAmounts[t].string);this.youAmounts[t].string=(n+e).toString()}},e.updatePotAmounts=function(t){for(var e=0;e<this.constants.BOARD.COUNT;e++)this.potAmounts[e+1].string=Number(t[e]).toString()},e.resetBoardAmounts=function(){for(var t=1;t<=this.constants.BOARD.COUNT;t++)this.youAmounts[t].string="0",this.potAmounts[t].string="0"},e.setAllBoardsOpacity=function(t){this.boards.forEach(function(e){return e.opacity=t}),this.frames.forEach(function(e){return e.opacity=t})},e.highlightWinnerBoard=function(t){this.setAllBoardsOpacity(100);var e=this.boardsNode.getChildByName("Board_"+t),n=this.framesNode.getChildByName("Frame_"+t);return e&&(e.opacity=255),n&&(n.opacity=255),e},e.animateWinnerBlink=function(t){var e=this.boardsNode.getChildByName("Board_"+t);if(e){var n=e.getChildByName("Anime");if(n){n.active=!0;for(var r=cc.tween(n),i=0;i<this.constants.ANIMATION.WINNER_BLINK_TIMES;i++){var o=this.constants.ANIMATION.WINNER_BLINK_DURATION/(2*this.constants.ANIMATION.WINNER_BLINK_TIMES);r=r.to(o,{opacity:0}).to(o,{opacity:255})}r.call(function(){return n.active=!1}).start()}}},e.addShadows=function(){for(var t=1;t<=this.constants.BOARD.COUNT;t++)for(var e=0,n=["Pot","You"];e<n.length;e++)for(var r=n[e],i=0,o=["Amount","Info"];i<o.length;i++){var a=o[i],s=cc.find("Canvas/MainController/MainBody/Boards/Board_"+t+"/"+r+"/"+a);if(s){var c=s.addComponent(cc.LabelShadow);c.color=new cc.Color(0,0,0,163),c.offset=cc.v2(0,-5),c.blur=5}}},e.getBoards=function(){return this.boards},t}();n.BoardUI=r,cc._RF.pop()},{}],CoinEncoder:[function(t,e,n){"use strict";cc._RF.push(e,"6bf17G1EL9JsZ8VW4p0kCOa","CoinEncoder"),n.__esModule=!0,n.CoinEncoder=void 0;var r=function(){function t(t){this.constants=t}var e=t.prototype;return e.encode=function(t,e){return(t-1)*this.constants.COIN.TYPES+(e-1)},e.decode=function(t){return{board:Math.floor(t/this.constants.COIN.TYPES)+1,coin:t%this.constants.COIN.TYPES+1}},t}();n.CoinEncoder=r,cc._RF.pop()},{}],DataValidator:[function(t,e,n){"use strict";function r(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(n)return(n=n.call(t)).next.bind(n);if(Array.isArray(t)||(n=i(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0;return function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function i(t,e){if(t){if("string"==typeof t)return o(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(t,e):void 0}}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}cc._RF.push(e,"783c8d0qzZP17sastITEU78","DataValidator"),n.__esModule=!0,n.DataValidator=void 0;var a=function(){function t(t,e){this.constants=t,this.logger=e}var e=t.prototype;return e.validateResponse=function(t,e){if(!t||"object"!=typeof t)return{valid:!1,error:"Invalid response format"};for(var n,i=r(e);!(n=i()).done;){var o=n.value;if(!(o in t))return this.logger.error("Missing required field: "+o),{valid:!1,error:"Missing field: "+o}}return{valid:!0}},e.validateGameUpdate=function(t){if(!t||"object"!=typeof t)return{valid:!1,error:"Invalid game update data"};if("t"in t){var e=Number(t.t);if(isNaN(e)||e<0||e>100)return{valid:!1,error:"Invalid board time"}}if("b"in t){if(!Array.isArray(t.b))return{valid:!1,error:"Bets must be an array"};if(t.b.length>1e3)return{valid:!1,error:"Bets array too large"}}if("a"in t){if(!Array.isArray(t.a))return{valid:!1,error:"Amounts must be an array"};if(t.a.length!==this.constants.BOARD.COUNT)return{valid:!1,error:"Invalid amounts array length"};if(!t.a.every(function(t){return"number"==typeof t&&t>=0}))return{valid:!1,error:"Invalid amount values"}}if("w"in t){var n=this.validateWinnerData(t.w);if(!n.valid)return n}return{valid:!0}},e.validateWinnerData=function(t){if(!t||"object"!=typeof t)return{valid:!1,error:"Invalid winner data"};if(!("w"in t))return{valid:!1,error:"Missing winner info"};var e=t.w;return"board"in e&&"number"==typeof e.board?e.board<1||e.board>this.constants.BOARD.COUNT?{valid:!1,error:"Winner board out of range"}:"frame"in e&&"number"==typeof e.frame?e.frame<0||e.frame>360?{valid:!1,error:"Winner frame out of range"}:{valid:!0}:{valid:!1,error:"Invalid winner frame"}:{valid:!1,error:"Invalid winner board"}},e.validateBalance=function(t){var e=Number(t);return isNaN(e)||!isFinite(e)?{valid:!1,error:"Invalid balance format"}:e<0?{valid:!1,error:"Balance cannot be negative"}:e>Number.MAX_SAFE_INTEGER/2?(this.logger.warn("Suspiciously large balance value"),{valid:!1,error:"Invalid balance value"}):{valid:!0}},e.validateBetData=function(t){return t&&"object"==typeof t?"rank"in t&&"number"==typeof t.rank?t.rank<1||t.rank>this.constants.USER.MAX_RANK?{valid:!1,error:"Rank out of range"}:Array.isArray(t.coins)?0===t.coins.length?{valid:!1,error:"Coins array cannot be empty"}:t.coins.length>100?{valid:!1,error:"Too many coins in bet"}:t.coins.every(function(t){return"number"==typeof t&&t>=0})?"number"!=typeof t.amount||t.amount<=0?{valid:!1,error:"Invalid bet amount"}:"number"!=typeof t.board?{valid:!1,error:"Invalid board number"}:t.board<1||t.board>this.constants.BOARD.COUNT?{valid:!1,error:"Board number out of range"}:{valid:!0}:{valid:!1,error:"Invalid coin values"}:{valid:!1,error:"Coins must be an array"}:{valid:!1,error:"Invalid rank"}:{valid:!1,error:"Invalid bet data"}},e.validateActiveUsers=function(t){if(!Array.isArray(t))return{valid:!1,error:"Users must be an array"};if(t.length>1e3)return{valid:!1,error:"Too many users"};for(var e,n=r(t);!(e=n()).done;){var i=e.value;if(!i||"object"!=typeof i)return{valid:!1,error:"Invalid user object"};if(!("name"in i)||"string"!=typeof i.name)return{valid:!1,error:"Invalid user name"};if(!("image"in i)||"string"!=typeof i.image)return{valid:!1,error:"Invalid user image"};if(i.image.length>500)return{valid:!1,error:"User image URL too long"}}return{valid:!0}},e.validateTrends=function(t){if(!Array.isArray(t))return{valid:!1,error:"Trends must be an array"};if(t.length>100)return{valid:!1,error:"Trends array too large"};for(var e,n=r(t);!(e=n()).done;){var i=e.value,o=Number(i);if(isNaN(o)||o<1||o>this.constants.BOARD.COUNT)return{valid:!1,error:"Invalid trend value"}}return{valid:!0}},e.detectTampering=function(t){try{return JSON.stringify(t).length>1e6?(this.logger.warn("Suspiciously large data payload"),!0):!!function t(e,n){if(void 0===n&&(n=0),n>10)return!0;if("object"!=typeof e||null===e)return!1;for(var r in e)if(t(e[r],n+1))return!0;return!1}(t)&&(this.logger.warn("Excessively nested data structure"),!0)}catch(e){return this.logger.error("Error checking for tampering:",e),!0}},t}();n.DataValidator=a,cc._RF.pop()},{}],EventHandlers:[function(t,e,n){"use strict";cc._RF.push(e,"96bf4n8FNpNUaSo4lpRle7w","EventHandlers"),n.__esModule=!0,n.EventHandlers=void 0;var r=function(){function t(t,e,n,r,i,o){this.constants=t,this.state=e,this.bettingController=n,this.audio=r,this.socket=i,this.logger=o,this.coinNode=null,this.coinChildren=null,this.clock=null,this.clockTime=null}var e=t.prototype;return e.initialize=function(t,e,n){this.coinNode=t,this.coinChildren=t.children,this.clock=e,this.clockTime=n},e.setupBoardClickHandlers=function(t,e){var n=this;t.forEach(function(t){t.on("touchend",function(t){var r=n.state.getGameState();if(r.clickAllowed){var i=Number(t.target.name.split("_")[1]),o=n.bettingController.placeBet(i,e);o.success?(e.boardUI.showCoinAnimation(i,r.selectedCoinNumber),n.audio.playCoinSound()):e.popupManager.toastrNotice(o.error,e)}},e)})},e.setupCoinClickHandlers=function(t){var e=this;this.animateCoin("Coin_1_500"),this.coinChildren.forEach(function(n){n.on("touchend",function(t){var n=t.target.name;e.coinChildren.forEach(function(t){var e=t.getChildByName("Coin"),n=t.getChildByName("Anime");e&&n&&(cc.Tween.stopAllByTarget(e),cc.Tween.stopAllByTarget(n),n.active=!1)}),e.animateCoin(n);var r=n.split("_"),i=Number(r[1]),o=Number(r[2]);e.state.updateSelectedCoin(i,o),e.audio.playEffectSound()},t)})},e.animateCoin=function(t){var e=this.coinNode.getChildByName(t);if(e){var n=e.getChildByName("Anime"),r=e.getChildByName("Coin");n&&r&&(n.active=!0,cc.tween(n).by(3,{angle:-360}).repeatForever().start(),cc.tween(r).by(3,{angle:360}).repeatForever().start())}},e.setupSocketListeners=function(t,e){var n=this;this.socket.on("GAME_UPDATE",function(e){t(e)}),this.socket.socket.on("disconnect",function(t){n.logger.error("Socket disconnected:",t),e.loadGameScene("Error")})},e.monitorConnection=function(t){var e=function(){return t.showReconnectPopup()};document.addEventListener("visibilitychange",function(){document.hidden&&e()}),document.addEventListener("offline",function(){return e()})},e.setupMusicSlider=function(t){var e=this;if(t){var n=t.getChildByName("Music");if(n){var r=n.getChildByName("Slider");if(r){var i=r.getChildByName("FillBg"),o=r.getChildByName("Handle");if(i&&o){o.x=-284;var a=i.width,s=i.anchorX;this.audio.playMusic(!0);var c=0,u=function(){var t=Math.max(0,Math.min(1,c)),n=i.getComponent(cc.Sprite);n&&(n.fillRange=t);var r=-a*s;o.x=r+a*t,e.audio.setMusicVolume(t)};r.on("slide",function(t){c=t.progress,u()}),u()}}}}},e.setupEffectSlider=function(t){var e=this;if(t){var n=t.getChildByName("Effect");if(n){var r=n.getChildByName("Slider");if(r){var i=r.getChildByName("FillBg"),o=r.getChildByName("Handle");if(i&&o){var a=.5,s=i.width,c=i.anchorX,u=function(){var t=Math.max(0,Math.min(1,a)),n=i.getComponent(cc.Sprite);n&&(n.fillRange=t);var r=-s*c;o.x=r+s*t,e.audio.setEffectVolume(t)};r.on("slide",function(t){a=t.progress,u()}),u()}}}}},e.updateClock=function(t){t>this.constants.TIMING.BETTING_STOP&&t<this.constants.TIMING.BETTING_START?(this.clockTime.string=t-2,this.clock.active=!0):this.clock.active=!1},e.updateBalanceDisplay=function(t,e,n){e&&n&&(e.string=n.format(t))},t}();n.EventHandlers=r,cc._RF.pop()},{}],FruitLoopsGame:[function(t,e,n){"use strict";cc._RF.push(e,"27931wWo9NOW6ccTJvW/kC4","FruitLoopsGame"),n.__esModule=!0,n.FruitsLoopGame=void 0;var r=t("../config/GameConfig.js"),i=t("../utils/Logger.js"),o=t("../utils/BalanceFormatter.js"),a=t("../utils/CoinEncoder.js"),s=t("../utils/Validator.js"),c=t("../services/APIService.js"),u=t("../services/SocketService.js"),l=t("../services/AudioService.js"),h=t("../managers/StateManager.js"),f=t("../controllers/BettingController.js"),d=t("./components/BoardUI.js"),p=t("./components/WheelAnimator.js"),v=t("./components/PopupManager.js"),g=t("./components/EventHandlers.js");function m(){m=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},i=r.iterator||"@@iterator",o=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function s(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(S){s=function(t,e,n){return t[e]=n}}function c(t,e,n,r){var i=e&&e.prototype instanceof h?e:h,o=Object.create(i.prototype),a=new B(r||[]);return o._invoke=function(t,e,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return{value:void 0,done:!0}}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=A(a,n);if(s){if(s===l)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var c=u(t,e,n);if("normal"===c.type){if(r=n.done?"completed":"suspendedYield",c.arg===l)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r="completed",n.method="throw",n.arg=c.arg)}}}(t,n,a),o}function u(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(S){return{type:"throw",arg:S}}}t.wrap=c;var l={};function h(){}function f(){}function d(){}var p={};s(p,i,function(){return this});var v=Object.getPrototypeOf,g=v&&v(v(T([])));g&&g!==e&&n.call(g,i)&&(p=g);var y=d.prototype=h.prototype=Object.create(p);function N(t){["next","throw","return"].forEach(function(e){s(t,e,function(t){return this._invoke(e,t)})})}function b(t,e){function r(i,o,a,s){var c=u(t[i],t,o);if("throw"!==c.type){var l=c.arg,h=l.value;return h&&"object"==typeof h&&n.call(h,"__await")?e.resolve(h.__await).then(function(t){r("next",t,a,s)},function(t){r("throw",t,a,s)}):e.resolve(h).then(function(t){l.value=t,a(l)},function(t){return r("throw",t,a,s)})}s(c.arg)}var i;this._invoke=function(t,n){function o(){return new e(function(e,i){r(t,n,e,i)})}return i=i?i.then(o,o):o()}}function A(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,A(t,e),"throw"===e.method))return l;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}var r=u(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,l;var i=r.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,l):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,l)}function C(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function E(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function B(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(C,this),this.reset(!0)}function T(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,o=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:w}}function w(){return{value:void 0,done:!0}}return f.prototype=d,s(y,"constructor",d),s(d,"constructor",f),f.displayName=s(d,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,s(t,a,"GeneratorFunction")),t.prototype=Object.create(y),t},t.awrap=function(t){return{__await:t}},N(b.prototype),s(b.prototype,o,function(){return this}),t.AsyncIterator=b,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var a=new b(c(e,n,r,i),o);return t.isGeneratorFunction(n)?a:a.next().then(function(t){return t.done?t.value:a.next()})},N(y),s(y,a,"Generator"),s(y,i,function(){return this}),s(y,"toString",function(){return"[object Generator]"}),t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=T,B.prototype={constructor:B,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(E),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=n.call(o,"catchLoc"),c=n.call(o,"finallyLoc");if(s&&c){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,l):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),l},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),E(n),l}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;E(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:T(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),l}},t}function y(t,e,n,r,i,o,a){try{var s=t[o](a),c=s.value}catch(u){return void n(u)}s.done?e(c):Promise.resolve(c).then(r,i)}function N(t){return function(){var e=this,n=arguments;return new Promise(function(r,i){var o=t.apply(e,n);function a(t){y(o,r,i,a,s,"next",t)}function s(t){y(o,r,i,a,s,"throw",t)}a(void 0)})}}var b=cc.Class({extends:cc.Component,properties:{UsersAmount:cc.Label,Coin1:cc.Prefab,Coin2:cc.Prefab,Coin3:cc.Prefab,Coin4:cc.Prefab,Coin5:cc.Prefab,CoinInsertBoard1:cc.Node,CoinInsertBoard2:cc.Node,CoinInsertBoard3:cc.Node,BackgroundMusic:cc.AudioClip,EffectMusic:cc.AudioClip,ActiveUser:cc.Prefab,Trend:cc.Prefab,PlayCoins:cc.AudioClip},onLoad:function(){this.config=new r.GameConfig,this.logger=new i.Logger(this.config.config),this.formatter=new o.BalanceFormatter,this.encoder=new a.CoinEncoder(this.config.constants),this.validator=new s.Validator(this.config.constants,this.logger),this.api=new c.APIService(this.config.config,this.config.endpoints,this.config.constants,this.logger),this.socket=new u.SocketService(this.config.config,this.logger),this.audio=new l.AudioService(this.config.constants),this.state=new h.StateManager(this.config.constants,this.logger),this.bettingController=new f.BettingController(this.config.constants,this.state,this.api,this.validator,this.encoder,this.logger),this.boardUI=new d.BoardUI(this.config.constants,this.formatter,this.logger),this.wheelAnimator=new p.WheelAnimator(this.config.constants,this.logger),this.popupManager=new v.PopupManager(this.config.constants,this.audio,this.logger),this.eventHandlers=new g.EventHandlers(this.config.constants,this.state,this.bettingController,this.audio,this.socket,this.logger),this.CONSTANTS=this.config.constants,this.parseURLParameters(),this.serverInfo()},init:function(){var t=this;return N(m().mark(function e(){return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.cacheAllNodes(),t.initializeComponents(),t.setupAudio(),t.setupAllEventListeners(),t.joinNextBoard();case 5:case"end":return e.stop()}},e)}))()},parseURLParameters:function(){var t=window.location.search.substring(1),e=this.parseQueryString(t).token;this.state.setToken(e),this.api.setToken(e)},parseQueryString:function(t){var e={};return t?(t.split("&").forEach(function(t){var n=t.split("="),r=n[0],i=n[1];r&&(e[r]=decodeURIComponent(i||""))}),e):e},cacheAllNodes:function(){this.cacheRootNodes(),this.cacheHeaderNodes()},cacheRootNodes:function(){this.canvas=cc.find("Canvas"),this.mainController=this.canvas.getChildByName("MainController"),this.mainBody=this.mainController.getChildByName("MainBody"),this.mainHeader=this.mainController.getChildByName("MainHeader"),this.mainFooter=this.mainController.getChildByName("MainFooter"),this.popup=this.mainController.getChildByName("Popup")},cacheHeaderNodes:function(){var t=this.mainHeader.getChildByName("Icons");this.clock=t.getChildByName("Clock"),this.clockTime=this.clock.getChildByName("Time").getComponent(cc.Label);var e=this.mainHeader.getChildByName("Wheel").getChildByName("SpinerWrapper");this.wheel=e.getChildByName("FruitsLoopSpiner"),this.fireEffect=e.getChildByName("FireEffect");var n=t.getChildByName("IconActiveUsers");this.PNL=n.getChildByName("PNL");var r=this.mainFooter.getChildByName("BalanceWrapper");this.coinNode=r.getChildByName("Coins");var i=this.mainBody.getChildByName("RankUsers");this.userNodes=[null];for(var o=1;o<=this.CONSTANTS.USER.MAX_RANK;o++)this.userNodes.push(i.getChildByName("User_"+o))},initializeComponents:function(){var t=[null,this.CoinInsertBoard1,this.CoinInsertBoard2,this.CoinInsertBoard3],e=[null,this.Coin1,this.Coin2,this.Coin3,this.Coin4,this.Coin5];this.boardUI.initialize(this.mainBody,t,e),this.wheelAnimator.initialize(this.wheel,this.fireEffect,this.userNodes,this.PNL),this.popupManager.initialize(this.popup),this.eventHandlers.initialize(this.coinNode,this.clock,this.clockTime)},setupAudio:function(){this.audio.setAudioClips({music:this.BackgroundMusic,effect:this.EffectMusic,coins:this.PlayCoins});var t=this.popupManager.getSettingsPopup();this.eventHandlers.setupMusicSlider(t),this.eventHandlers.setupEffectSlider(t)},setupAllEventListeners:function(){var t=this,e=this.boardUI.getBoards();this.eventHandlers.setupBoardClickHandlers(e,this),this.eventHandlers.setupCoinClickHandlers(this),this.eventHandlers.setupSocketListeners(function(e){return t.handleGameUpdate(e)},this),this.eventHandlers.monitorConnection(this.popupManager),this.boardUI.addShadows()},handleGameUpdate:function(t){var e=Number(t.t);this.state.updateBoardTime(e),t.w&&this.playWheelAnimation(t.w),e>0&&e<this.CONSTANTS.TIMING.BETTING_START&&(t.b&&this.updateBettingStatus({b:Array.from(new Uint16Array(t.b)),a:t.a}),this.wheelAnimator.setWheelAngle(128),this.wheelAnimator.hideFireEffect(),this.boardUI.setAllBoardsOpacity(255)),this.eventHandlers.updateClock(e),e>this.CONSTANTS.TIMING.BETTING_STOP&&e<this.CONSTANTS.TIMING.BETTING_START||this.state.setClickAllowed(!1),e===this.CONSTANTS.TIMING.BETTING_START_DISPLAY&&(this.boardUI.clearAllCoins(),this.popupManager.showNotice("START BETTING",this.CONSTANTS.TIMING.BETTING_START_DISPLAY_DURATION,this)),e===this.CONSTANTS.TIMING.BETTING_DISABLE&&this.state.setClickAllowed(!1),e===this.CONSTANTS.TIMING.BETTING_ALLOWED&&this.state.setClickAllowed(!0),e===this.CONSTANTS.TIMING.BETTING_STOP&&(this.popupManager.showNotice("STOP BETTING",0,this),this.bettingController.forceSendPendingBets(this))},updateBettingStatus:function(t){var e=this,n=this.state.getMyLastBets();t.b.forEach(function(t){if(!n.includes(t)){var r=e.encoder.decode(t),i=r.board,o=r.coin;e.boardUI.showCoinAnimation(i,o)}}),this.boardUI.updatePotAmounts(t.a),this.state.clearMyLastBets()},playWheelAnimation:function(t){var e=this;this.popupManager.hideNotice(),this.wheelAnimator.playWheelAnimation(t,function(t,n,r){e.revealWinner(t,n,r)})},revealWinner:function(t,e,n){var r=this;this.boardUI.highlightWinnerBoard(t.board),this.boardUI.animateWinnerBlink(t.board),this.scheduleOnce(function(){r.resetAfterWinner(),r.wheelAnimator.showPNLAnimations(e,n)},4)},resetAfterWinner:function(){this.getUserInfo(),this.bettingController.resetBets(),this.boardUI.resetBoardAmounts(),this.boardUI.setAllBoardsOpacity(255),this.wheelAnimator.hideFireEffect()},serverInfo:function(){var t=this;return N(m().mark(function e(){var n;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.api.getServerInfo();case 3:if((n=e.sent).receivedData&&n.receivedData.status){e.next=7;break}return t.loadGameScene("Error"),e.abrupt("return");case 7:return t.api.setBaseUrl(n.receivedData.URL),e.next=10,t.socket.connect(n.receivedData.URL,t.state.getToken());case 10:return e.next=12,t.authenticate();case 12:e.next=18;break;case 14:e.prev=14,e.t0=e.catch(0),t.logger.error("Server info failed:",e.t0),t.loadGameScene("Error");case 18:case"end":return e.stop()}},e,null,[[0,14]])}))()},authenticate:function(){var t=this;return N(m().mark(function e(){var n;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.api.getGameData(t.state.getToken());case 3:if((n=e.sent).receivedData&&n.receivedData.status){e.next=7;break}return t.loadGameScene("Error"),e.abrupt("return");case 7:t.state.initializeUser(n.receivedData),t.init(),t.getUserInfo(),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(0),t.logger.error("Authentication failed:",e.t0),t.loadGameScene("Error");case 16:case"end":return e.stop()}},e,null,[[0,12]])}))()},getUserInfo:function(){var t=this;return N(m().mark(function e(){var n;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.api.getUserInfo();case 3:if(!(n=e.sent).amount||"RELOAD"!==n.amount.msg){e.next=7;break}return t.loadGameScene("Error"),e.abrupt("return");case 7:void 0!==n.amount&&(t.state.updateUserBalance(n.amount),t.eventHandlers.updateBalanceDisplay(n.amount,t.UsersAmount,t.formatter)),n.active_users&&t.updateActiveUsers(n.active_users,n.total_active_users),n.trends&&t.updateTrends(n.trends),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(0),t.logger.error("Get user info failed:",e.t0),t.loadGameScene("Error");case 16:case"end":return e.stop()}},e,null,[[0,12]])}))()},updateActiveUsers:function(t,e){var n=this;this.popupManager.updateActiveUsers(t,e,this.ActiveUser);for(var r=1;r<=6;r++)this.userNodes[r]&&(this.userNodes[r].active=!1);var i=this.state.getUser();t.forEach(function(t,e){if(!(e>=6)){var r=e+1;Number(t.token)===Number(i.token)&&n.updateUserRank(r);var o=n.userNodes[r];if(o){o.active=!0;var a=o.getChildByName("Profile");if(a){var s=a.getComponent(cc.Sprite);if(s){var c=t.image.replace(/\s+/g,"");cc.assetManager.loadRemote(c,function(t,e){t||(s.spriteFrame=new cc.SpriteFrame(e))})}}}}})},updateTrends:function(t){this.popupManager.updateTrends(t,this.Trend)},updateUserRank:function(t){var e=this;return N(m().mark(function n(){var r,i;return m().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,r={rank:t},n.next=4,e.api.updateUserRank(r);case 4:if(!(i=n.sent)||"RELOAD"!==i.msg){n.next=8;break}return e.loadGameScene("Error"),n.abrupt("return");case 8:e.state.setUserRank(t),n.next=15;break;case 11:n.prev=11,n.t0=n.catch(0),e.logger.error("Update user rank failed:",n.t0),e.loadGameScene("Error");case 15:case"end":return n.stop()}},n,null,[[0,11]])}))()},loadGameScene:function(t){cc.director.loadScene(t)},joinNextBoard:function(){var t=this;this.popupManager.joinNextBoard(function(){return t.getUserInfo()})},openActiveUsers:function(){var t=this;this.popupManager.openActiveUsers(function(){return t.getUserInfo()})},closeActiveUsers:function(){this.popupManager.closeActiveUsers()},openTrend:function(){this.popupManager.openTrend()},closeTrend:function(){this.popupManager.closeTrend()},openSettings:function(){this.popupManager.openSettings()},closeSettings:function(){this.popupManager.closeSettings()},openInstruction:function(){this.popupManager.openInstruction()},closeInstruction:function(){this.popupManager.closeInstruction()}});n.FruitsLoopGame=b,cc._RF.pop()},{"../config/GameConfig.js":"GameConfig","../controllers/BettingController.js":"BettingController","../managers/StateManager.js":"StateManager","../services/APIService.js":"APIService","../services/AudioService.js":"AudioService","../services/SocketService.js":"SocketService","../utils/BalanceFormatter.js":"BalanceFormatter","../utils/CoinEncoder.js":"CoinEncoder","../utils/Logger.js":"Logger","../utils/Validator.js":"Validator","./components/BoardUI.js":"BoardUI","./components/EventHandlers.js":"EventHandlers","./components/PopupManager.js":"PopupManager","./components/WheelAnimator.js":"WheelAnimator"}],GameConfig:[function(t,e,n){"use strict";var r;function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}cc._RF.push(e,"7a1934h61tCupeZMFz31F9h","GameConfig"),n.__esModule=!0,n.getCurrentEnv=n.GameConfig=n.ENV_CONFIG=n.ENV=n.ENDPOINTS=n.CONSTANTS=void 0;var o={DEVELOPMENT:"development",PRODUCTION:"production"};n.ENV=o;var a=function(){var t=window.location.hostname;return t.includes("localhost")||t.includes("127.0.0.1")?o.DEVELOPMENT:o.PRODUCTION};n.getCurrentEnv=a;var s=((r={})[o.DEVELOPMENT]={apiBaseUrl:"http://localhost:3000",socketNamespace:"/game",debug:!0,logLevel:"verbose"},r[o.PRODUCTION]={apiBaseUrl:"https://vudoo-fruits-game.vudoolive.com",socketNamespace:"/game",debug:!1,logLevel:"error"},r);n.ENV_CONFIG=s;var c={BOARD:{COUNT:3,MAX_SELECTION:2,POSITIONS:{1:{minX:-630,maxX:-500,minY:-510,maxY:-410},2:{minX:-378,maxX:-263,minY:-510,maxY:-410},3:{minX:-153,maxX:-19,minY:-510,maxY:-410}}},USER:{MAX_RANK:6},COIN:{TYPES:5,VALUES:[500,1e3,5e3,1e4,5e4],DEFAULT_NUMBER:1,DEFAULT_AMOUNT:500},TIMING:{BETTING_START:13,BETTING_ALLOWED:13,BETTING_DISABLE:3,BETTING_STOP:2,DEBOUNCE_DELAY:350,WHEEL_SPIN_DURATION:7,WINNER_REVEAL_DELAY:7.2,PNL_DISPLAY_DURATION:3,BETTING_START_DISPLAY:14,BETTING_START_DISPLAY_DURATION:2,TOAST_DISPLAY_DURATION:1.5,RECONNECT_COUNTDOWN:10},ANIMATION:{COIN_FALL_DURATION:.6,POPUP_OPEN_DURATION:.3,POPUP_CLOSE_DURATION:.3,WINNER_BLINK_TIMES:5,WINNER_BLINK_DURATION:3},AUDIO:{DEFAULT_EFFECT_VOLUME:.1,DEFAULT_MUSIC_VOLUME:0},NETWORK:{REQUEST_TIMEOUT:1e4}};n.CONSTANTS=c;var u={SERVER_INFO:"/game/server-info",GAME_DATA:"/game/game-data",BETTING_INSERT:"/game/betting-insert",USER_INFO:"/game/user-info",USER_RANK:"/game/update-rank",SOCKET:{GAME_UPDATE:"GAME_UPDATE"}};n.ENDPOINTS=u;var l=function(){function t(){this.currentEnv=a(),this.config=s[this.currentEnv],this.constants=c,this.endpoints=u}var e,n;return e=t,(n=[{key:"apiBaseUrl",get:function(){return this.config.apiBaseUrl}},{key:"socketNamespace",get:function(){return this.config.socketNamespace}},{key:"debug",get:function(){return this.config.debug}},{key:"logLevel",get:function(){return this.config.logLevel}}])&&i(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();n.GameConfig=l,cc._RF.pop()},{}],Logger:[function(t,e,n){"use strict";cc._RF.push(e,"47011s/lBVATZiAktvskh5J","Logger"),n.__esModule=!0,n.Logger=void 0;var r=function(){function t(t){this.config=t}var e=t.prototype;return e.debug=function(){if(this.config.debug){for(var t,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];(t=console).log.apply(t,["[DEBUG]"].concat(n))}},e.info=function(){if("verbose"===this.config.logLevel||"info"===this.config.logLevel){for(var t,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];(t=console).log.apply(t,["[INFO]"].concat(n))}},e.warn=function(){for(var t,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];(t=console).warn.apply(t,["[WARN]"].concat(n))},e.error=function(){for(var t,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];(t=console).error.apply(t,["[ERROR]"].concat(n))},e.logRequest=function(t,e,n){void 0===n&&(n=null),this.config.debug&&console.log("[REQUEST] "+t+" "+e,n)},e.logResponse=function(t,e){this.config.debug&&console.log("[RESPONSE] "+t,e)},t}();n.Logger=r,cc._RF.pop()},{}],PopupManager:[function(t,e,n){"use strict";cc._RF.push(e,"7696bvsb85HZ6paD0nl+YW4","PopupManager"),n.__esModule=!0,n.PopupManager=void 0;var r=function(){function t(t,e,n){this.constants=t,this.audio=e,this.logger=n,this.notice=null,this.noticeTitle=null,this.activeUsersPopup=null,this.trendPopup=null,this.settingsPopup=null,this.jackpotPopup=null,this.instructionPopup=null,this.connectionPopup=null,this.currentOnline=null,this.currentOnlineCount=null,this.activeUsersContainer=null,this.trendsContainer=null,this.scheduledCallbacks=[]}var e=t.prototype;return e.initialize=function(t){if(this.notice=t.getChildByName("Notice"),this.noticeTitle=this.notice.getChildByName("Title").getComponent(cc.Label),this.activeUsersPopup=t.getChildByName("ActiveUsers"),this.trendPopup=t.getChildByName("Trend"),this.settingsPopup=t.getChildByName("Settings"),this.jackpotPopup=t.getChildByName("Jackpot"),this.instructionPopup=t.getChildByName("Instruction"),this.connectionPopup=t.getChildByName("Connection"),this.activeUsersPopup){this.currentOnline=this.activeUsersPopup.getChildByName("CurrentOnline"),this.currentOnlineCount=this.currentOnline.getChildByName("Count");var e=this.activeUsersPopup.getChildByName("ScrollView");this.activeUsersContainer=e.getChildByName("Users")}if(this.trendPopup){var n=this.trendPopup.getChildByName("ScrollView");this.trendsContainer=n.getChildByName("Trends")}},e.toastrNotice=function(t,e){var n=this;cc.Tween.stopAllByTarget(this.notice),this.clearScheduledCallbacks(e),this.notice.active=!0,this.notice.opacity=0,this.notice.scale=.5,this.noticeTitle.string=t,cc.tween(this.notice).to(.3,{opacity:255,scale:1},{easing:"backOut"}).start();var r=e.scheduleOnce(function(){cc.tween(n.notice).to(.2,{opacity:0,scale:.5},{easing:"backIn"}).call(function(){n.notice.active=!1,n.notice.opacity=255,n.notice.scale=1}).start()},this.constants.TIMING.TOAST_DISPLAY_DURATION);this.scheduledCallbacks.push(r),this.audio.playEffectSound()},e.showNotice=function(t,e,n){var r=this;this.notice.active=!0,this.noticeTitle.string=t,0!==e&&n&&n.scheduleOnce(function(){r.notice.active=!1},e)},e.hideNotice=function(){this.notice.active=!1},e.openPopup=function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=null),t&&(t.active=!0,t.opacity=0,t.scale=.5,cc.tween(t).to(.3,{opacity:255,scale:1},{easing:"backOut"}).start(),e&&n&&(e.active=!0,n.active=!1))},e.closePopup=function(t){t&&(cc.tween(t).to(.3,{opacity:0,scale:.5},{easing:"backIn"}).call(function(){return t.active=!1}).start(),this.audio.playEffectSound())},e.openActiveUsers=function(t){if(this.activeUsersPopup){var e=this.activeUsersPopup.getChildByName("Loading"),n=this.activeUsersPopup.getChildByName("ScrollView");this.openPopup(this.activeUsersPopup,e,n),t&&t()}},e.closeActiveUsers=function(){this.closePopup(this.activeUsersPopup)},e.openTrend=function(){if(this.trendPopup){var t=this.trendPopup.getChildByName("Loading"),e=this.trendPopup.getChildByName("ScrollView");this.openPopup(this.trendPopup,t,e)}},e.closeTrend=function(){this.closePopup(this.trendPopup)},e.openSettings=function(){if(this.settingsPopup){var t=this.settingsPopup.getChildByName("Loading"),e=this.settingsPopup.getChildByName("ScrollView");this.openPopup(this.settingsPopup,t,e)}},e.closeSettings=function(){this.closePopup(this.settingsPopup)},e.openInstruction=function(){if(this.instructionPopup){var t=this.instructionPopup.getChildByName("Loading"),e=this.instructionPopup.getChildByName("ScrollView");this.openPopup(this.instructionPopup,t,e)}},e.closeInstruction=function(){this.closePopup(this.instructionPopup)},e.showReconnectPopup=function(){var t=this;if(this.connectionPopup){var e=this.connectionPopup.getChildByName("Title").getComponent(cc.Label);this.connectionPopup.active=!0;var n=this.constants.TIMING.RECONNECT_COUNTDOWN,r=setInterval(function(){--n<1?(clearInterval(r),t.connectionPopup.active=!1):e.string="Reconnect in "+n+"s later"},1e3)}},e.joinNextBoard=function(t){var e=this;if(this.connectionPopup){var n=this.connectionPopup.getChildByName("Title").getComponent(cc.Label);this.connectionPopup.active=!0,n.string="Reconnect...";var r=this.constants.TIMING.RECONNECT_COUNTDOWN,i=setInterval(function(){--r<1?(clearInterval(i),e.connectionPopup.active=!1,t&&t()):n.string="Reconnect in "+r+"s later"},1e3)}},e.updateActiveUsers=function(t,e,n){var r=this;if(this.currentOnlineCount&&(this.currentOnlineCount.getComponent(cc.Label).string=e),this.activeUsersContainer){var i=[];t.forEach(function(t){var e=cc.instantiate(n);e.getChildByName("Name").getComponent(cc.Label).string=t.name;var r=e.getChildByName("Profile").getChildByName("Profile").getComponent(cc.Sprite),o=t.image.replace(/\s+/g,"");cc.assetManager.loadRemote(o,function(t,e){t||(r.spriteFrame=new cc.SpriteFrame(e))}),i.push(e)}),this.activeUsersContainer.removeAllChildren(),i.forEach(function(t){r.activeUsersContainer.addChild(t)})}},e.updateTrends=function(t,e){var n=this;if(this.trendsContainer){var r=[];t.forEach(function(t){var n=cc.instantiate(e),i=n.getChildByName(String(t)).getComponent(cc.Sprite);cc.resources.load("image/FruitsLoop/Win",cc.SpriteFrame,function(t,e){t||(i.spriteFrame=e)}),r.push(n)}),this.trendsContainer.removeAllChildren(),r.forEach(function(t){n.trendsContainer.addChild(t)})}},e.clearScheduledCallbacks=function(t){t&&t.unscheduleAllCallbacks&&t.unscheduleAllCallbacks(),this.scheduledCallbacks=[]},e.getSettingsPopup=function(){return this.settingsPopup},t}();n.PopupManager=r,cc._RF.pop()},{}],RateLimiter:[function(t,e,n){"use strict";cc._RF.push(e,"8be61vPRqRKBbnHelkuy0Lc","RateLimiter"),n.__esModule=!0,n.RateLimiter=n.ActionRateLimiter=void 0;var r=function(){function t(t,e,n){void 0===n&&(n=null),this.maxTokens=t,this.tokens=t,this.refillRate=e,this.lastRefill=Date.now(),this.logger=n}var e=t.prototype;return e.refill=function(){var t=Date.now(),e=(t-this.lastRefill)/1e3*this.refillRate;this.tokens=Math.min(this.maxTokens,this.tokens+e),this.lastRefill=t},e.tryConsume=function(t){return void 0===t&&(t=1),this.refill(),this.tokens>=t?(this.tokens-=t,!0):(this.logger&&this.logger.warn("Rate limit exceeded"),!1)},e.getAvailableTokens=function(){return this.refill(),Math.floor(this.tokens)},e.reset=function(){this.tokens=this.maxTokens,this.lastRefill=Date.now()},e.getTimeUntilNextToken=function(){return this.tokens>=this.maxTokens?0:1/this.refillRate},t}();n.RateLimiter=r;var i=function(){function t(t){void 0===t&&(t=null),this.limiters=new Map,this.logger=t}var e=t.prototype;return e.register=function(t,e,n){this.limiters.set(t,new r(e,n,this.logger))},e.isAllowed=function(t,e){void 0===e&&(e=1);var n=this.limiters.get(t);return n?n.tryConsume(e):(this.logger&&this.logger.warn("No rate limiter for action: "+t),!0)},e.getAvailableTokens=function(t){var e=this.limiters.get(t);return e?e.getAvailableTokens():0},e.reset=function(t){var e=this.limiters.get(t);e&&e.reset()},e.resetAll=function(){this.limiters.forEach(function(t){return t.reset()})},t}();n.ActionRateLimiter=i,cc._RF.pop()},{}],Sanitizer:[function(t,e,n){"use strict";cc._RF.push(e,"140f7JQwGJEnZ6KZ6wh5Ln3","Sanitizer"),n.__esModule=!0,n.Sanitizer=void 0;var r=function(){function t(){}return t.sanitizeString=function(t,e){if(void 0===e&&(e=100),"string"!=typeof t)return"";var n=t.trim().substring(0,e);return(n=(n=(n=n.replace(/<[^>]*>/g,"")).replace(/javascript:/gi,"")).replace(/on\w+\s*=/gi,"")).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")},t.sanitizeNumber=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=Number.MAX_SAFE_INTEGER);var r=Number(t);return isNaN(r)||!isFinite(r)?null:Math.max(e,Math.min(n,Math.floor(r)))},t.validateBoardNumber=function(t,e){return this.sanitizeNumber(t,1,e)},t.validateCoinAmount=function(t,e){var n=Number(t);return isNaN(n)||!e.includes(n)?null:n},t.sanitizeURL=function(t){return"string"!=typeof t?"":(t=(t=t.replace(/javascript:/gi,"")).replace(/data:/gi,""),encodeURI(t))},t.validateTokenFormat=function(t){return"string"==typeof t&&0!==t.length&&/^[a-zA-Z0-9\-_]+$/.test(t)},t.sanitizeObject=function(t){var e=this,n={};for(var r in t)if(t.hasOwnProperty(r)){var i=t[r];if(null==i)continue;"string"==typeof i?n[r]=this.sanitizeString(i):"number"==typeof i?n[r]=i:"boolean"==typeof i?n[r]=i:Array.isArray(i)?n[r]=i.map(function(t){return"object"==typeof t?e.sanitizeObject(t):t}):"object"==typeof i&&(n[r]=this.sanitizeObject(i))}return n},t.validateCoinArray=function(t,e){return void 0===e&&(e=100),!!Array.isArray(t)&&!(t.length>e)&&t.every(function(t){return"number"==typeof t&&isFinite(t)&&t>=0})},t.checkRateLimit=function(t,e,n){var r=Date.now(),i="ratelimit_"+t;try{var o=localStorage.getItem(i),a=o?JSON.parse(o):[];return!((a=a.filter(function(t){return r-t<n})).length>=e||(a.push(r),localStorage.setItem(i,JSON.stringify(a)),0))}catch(s){return!0}},t.detectSuspiciousPatterns=function(t){var e=JSON.stringify(t);return[/<script/i,/javascript:/i,/onerror=/i,/onclick=/i,/eval\(/i,/expression\(/i,/vbscript:/i,/onload=/i].some(function(t){return t.test(e)})},t}();n.Sanitizer=r,cc._RF.pop()},{}],SocketService:[function(t,e,n){"use strict";cc._RF.push(e,"8d18bwOyjdJtaTjO10w7Bej","SocketService"),n.__esModule=!0,n.SocketService=void 0;var r=function(){function t(t,e){this.config=t,this.logger=e,this.socket=null,this.connected=!1}var e=t.prototype;return e.connect=function(t,e){var n=this;return void 0===e&&(e=null),new Promise(function(r,i){try{var o=""+t+n.config.socketNamespace,a={transports:["websocket"],reconnection:!0,reconnectionDelay:1e3};e&&(a.query={token:e}),n.socket=io(o,a),n.socket.on("connect",function(){n.connected=!0,n.logger.info("Socket connected"),r()}),n.socket.on("disconnect",function(t){n.connected=!1,n.logger.warn("Socket disconnected:",t)})}catch(s){i(s)}})},e.on=function(t,e){this.socket&&this.socket.on(t,e)},e.emit=function(t,e){this.socket&&this.connected&&this.socket.emit(t,e)},e.disconnect=function(){this.socket&&(this.socket.disconnect(),this.socket=null,this.connected=!1)},t}();n.SocketService=r,cc._RF.pop()},{}],StateManager:[function(t,e,n){"use strict";cc._RF.push(e,"8bb5frDRMhE1IP6D8WC4hvX","StateManager"),n.__esModule=!0,n.User=n.StateManager=n.GameState=void 0;var r=function(){function t(t){this.constants=t,this.boardTime=0,this.clickAllowed=!1,this.selectedCoinNumber=t.COIN.DEFAULT_NUMBER,this.selectedCoinAmount=t.COIN.DEFAULT_AMOUNT,this.insertBoards=[],this.myLastBets=[],this.boardBets=Array.from({length:t.BOARD.COUNT+1},function(){return{amount:0,coins:[]}})}var e=t.prototype;return e.updateBoardTime=function(t){this.boardTime=t},e.setClickAllowedState=function(t){this.clickAllowed=t},e.updateSelectedCoin=function(t,e){this.selectedCoinNumber=t,this.selectedCoinAmount=e},e.addInsertBoard=function(t){this.insertBoards.includes(t)||this.insertBoards.push(t)},e.addBetToBoard=function(t,e,n){this.boardBets[t].amount+=n,this.boardBets[t].coins.push(e),this.myLastBets.push(e)},e.getBoardBets=function(t){return this.boardBets[t]},e.clearBoardBets=function(t){this.boardBets[t]={amount:0,coins:[]}},e.resetAllBets=function(){this.insertBoards=[],this.myLastBets=[],this.boardBets=Array.from({length:this.constants.BOARD.COUNT+1},function(){return{amount:0,coins:[]}})},t}();n.GameState=r;var i=function(){function t(t){void 0===t&&(t={}),this.token=t.token||"",this.name=t.name||"",this.image=t.image||"",this.amount=t.amount||0,this.rank=t.rank||null}var e=t.prototype;return e.updateBalance=function(t){this.amount=t},e.deductBalance=function(t){if(this.amount<t)throw new Error("Insufficient balance");this.amount-=t},e.addBalance=function(t){this.amount+=t},e.setRank=function(t){this.rank=t},t}();n.User=i;var o=function(){function t(t,e){this.constants=t,this.logger=e,this.user=new i,this.gameState=new r(t),this.token=null,this.listeners=[]}var e=t.prototype;return e.initializeUser=function(t){this.user=new i(t),this.notifyListeners("user",this.user)},e.updateUserBalance=function(t){this.user.updateBalance(t),this.notifyListeners("user",this.user)},e.deductBalance=function(t){this.user.deductBalance(t),this.notifyListeners("user",this.user)},e.setUserRank=function(t){this.user.setRank(t),this.notifyListeners("user",this.user)},e.getUser=function(){return this.user},e.updateBoardTime=function(t){this.gameState.updateBoardTime(t),this.notifyListeners("boardTime",t)},e.setClickAllowed=function(t){this.gameState.setClickAllowedState(t),this.notifyListeners("clickAllowed",t)},e.updateSelectedCoin=function(t,e){this.gameState.updateSelectedCoin(t,e),this.notifyListeners("selectedCoin",{coinNumber:t,coinAmount:e})},e.getGameState=function(){return this.gameState},e.addBettingBoard=function(t){this.gameState.addInsertBoard(t),this.notifyListeners("insertBoards",this.gameState.insertBoards)},e.addBet=function(t,e,n){this.gameState.addBetToBoard(t,e,n),this.notifyListeners("bet",{board:t,encodedCoin:e,amount:n})},e.getBoardBets=function(t){return this.gameState.getBoardBets(t)},e.clearBoardBets=function(t){this.gameState.clearBoardBets(t),this.notifyListeners("clearBet",t)},e.resetAllBets=function(){this.gameState.resetAllBets(),this.notifyListeners("resetBets",null)},e.getInsertBoards=function(){return this.gameState.insertBoards},e.getMyLastBets=function(){return this.gameState.myLastBets},e.clearMyLastBets=function(){this.gameState.myLastBets=[]},e.setToken=function(t){this.token=t},e.getToken=function(){return this.token},e.subscribe=function(t){var e=this;return this.listeners.push(t),function(){e.listeners=e.listeners.filter(function(e){return e!==t})}},e.notifyListeners=function(t,e){var n=this;this.listeners.forEach(function(r){try{r(t,e)}catch(i){n.logger.error("Listener error:",i)}})},t}();n.StateManager=o,cc._RF.pop()},{}],Validator:[function(t,e,n){"use strict";cc._RF.push(e,"ac2a4FiBqxPdJn57y3KQBmh","Validator"),n.__esModule=!0,n.Validator=void 0;var r=function(){function t(t,e){this.constants=t,this.logger=e}return t.prototype.validateBet=function(t){var e=t.boardNumber,n=t.coinAmount,r=t.userBalance,i=t.insertBoards;return r<n?{valid:!1,error:"Insufficient balance"}:e<1||e>this.constants.BOARD.COUNT?(this.logger.error("Invalid board number:",e),{valid:!1,error:"Invalid board number"}):i.length>=this.constants.BOARD.MAX_SELECTION&&!i.includes(e)?{valid:!1,error:"You can't select 3 boards in a single round."}:{valid:!0}},t}();n.Validator=r,cc._RF.pop()},{}],WheelAnimator:[function(t,e,n){"use strict";cc._RF.push(e,"88c9f03Is9Myq9WlbzU0DUL","WheelAnimator"),n.__esModule=!0,n.WheelAnimator=void 0;var r=function(){function t(t,e){this.constants=t,this.logger=e,this.wheel=null,this.fireEffect=null,this.userNodes=null,this.PNL=null}var e=t.prototype;return e.initialize=function(t,e,n,r){this.wheel=t,this.fireEffect=e,this.userNodes=n,this.PNL=r},e.playWheelAnimation=function(t,e){var n=t.w;cc.tween(this.wheel).to(this.constants.TIMING.WHEEL_SPIN_DURATION,{angle:-(2520+n.frame)},{easing:"cubicInOut"}).start(),this.scheduleFireEffect(),e&&setTimeout(function(){e(n,t.p,t.ap)},1e3*this.constants.TIMING.WINNER_REVEAL_DELAY)},e.scheduleFireEffect=function(){var t=this;setTimeout(function(){t.fireEffect.active=!0;var e=t.fireEffect.getComponent(cc.Animation);e&&e.play("FireEffect")},1e3*this.constants.TIMING.WHEEL_SPIN_DURATION)},e.resetWheel=function(){this.wheel.angle=128,this.fireEffect.active=!1},e.showPNLAnimations=function(t,e){this.showUserPNLs(t),this.showTotalPNL(e)},e.showUserPNLs=function(t){var e=this,n=Math.floor(5*Math.random())+2;t.slice().sort(function(){return Math.random()-.5}).slice(0,n).forEach(function(t){if(t.rank){var n=e.userNodes[t.rank];if(n){var r=n.getChildByName("PNL");r&&e.animateUserPNL(r,t.pnl)}}})},e.animateUserPNL=function(t,e){var n=t.getComponent(cc.Label),r=e<1?cc.Color.RED:cc.Color.GREEN,i=e<1?"-"+Math.abs(e):"+"+e;t.active=!0,t.color=r,n.string=i,cc.tween(t).to(.5,{scale:1,position:cc.v2(t.position.x,t.position.y+80)}).start(),setTimeout(function(){t.active=!1,cc.tween(t).to(.5,{position:cc.v2(t.position.x,-18.926)}).start()},1e3*this.constants.TIMING.PNL_DISPLAY_DURATION)},e.showTotalPNL=function(t){var e=this;if(this.PNL){var n=this.PNL.getComponent(cc.Label),r=t<1?cc.Color.RED:cc.Color.GREEN,i=t<1?"-"+Math.abs(t):"+"+t;this.PNL.active=!0,this.PNL.color=r,n.string=i,cc.tween(this.PNL).to(.5,{scale:1,position:cc.v2("-3","-50")}).start(),setTimeout(function(){e.PNL.active=!1,cc.tween(e.PNL).to(.5,{position:cc.v2("-65","-120")}).start(),e.resetWheel()},1e3*this.constants.TIMING.PNL_DISPLAY_DURATION)}},e.hideFireEffect=function(){this.fireEffect.active=!1},e.getWheelAngle=function(){return this.wheel.angle},e.setWheelAngle=function(t){this.wheel.angle=t},t}();n.WheelAnimator=r,cc._RF.pop()},{}],use_reversed_rotateBy:[function(t,e){"use strict";cc._RF.push(e,"b0688CKVLVEla9n8jA01C+8","use_reversed_rotateBy"),cc.RotateBy._reverse=!0,cc._RF.pop()},{}]},{},["use_reversed_rotateBy","GameConfig","BettingController","StateManager","DataValidator","RateLimiter","APIService","AudioService","SocketService","FruitLoopsGame","BoardUI","EventHandlers","PopupManager","WheelAnimator","BalanceFormatter","CoinEncoder","Logger","Sanitizer","Validator"]);